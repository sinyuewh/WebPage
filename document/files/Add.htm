<!DOCTYPE HTML>
<html>

<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<!--[if lt IE 9]>
<script type="text/javascript" src="../../lib/html5shiv.js"></script>
<script type="text/javascript" src="../../lib/respond.min.js"></script>
<![endif]-->
	<link rel="stylesheet" type="text/css" href="../../static/h-ui/css/H-ui.min.css" />
	<link rel="stylesheet" type="text/css" href="../../static/h-ui.admin/css/H-ui.admin.css" />
	<link rel="stylesheet" type="text/css" href="../../lib/Hui-iconfont/1.0.8/iconfont.css" />
	<link rel="stylesheet" type="text/css" href="../../static/h-ui.admin/skin/default/skin.css" id="skin" />
	<link rel="stylesheet" type="text/css" href="../../static/h-ui.admin/css/style.css" />
	<!--[if IE 6]>
<script type="text/javascript" src="../../lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
	<!--/meta 作为公共模版分离出去-->
	<title></title>
</head>

<body>
	<article class="page-container">
		<form class="form form-horizontal" id="form1" onsubmit="return false" >
		    <div class="row cl">
				<label class="form-label col-xs-4 col-sm-3">序号：</label>
				<div class="formControls col-xs-8 col-sm-8">
					<input type="text" class="input-text" value="" placeholder="" id="num">
				</div>
			</div>
			
			<div class="row cl">
				<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>文档标题：</label>
				<div class="formControls col-xs-8 col-sm-8">
					<input type="text" class="input-text" value="" placeholder="文档标题：" id="fileTitle" name="fileTitle">
				</div>
			</div>

            <div class="row cl">
				<label class="form-label col-xs-4 col-sm-3">相关附件：</label>
				<div class="formControls col-xs-8 col-sm-8">
					<span class="btn-upload form-group">
						<input class="input-text upload-url" type="text" name="uploadfile-2" id="uploadfile-2" readonly style="width:410px">
						&nbsp;<a href="javascript:void();" class="btn btn-primary upload-btn"><i class="Hui-iconfont">&#xe642;</i> 上传</a>
						<input type="file" multiple name="file-2" id="file" class="input-file">
					</span>
				</div>
			</div>
			
            <div class="row cl">
				<label class="form-label col-xs-4 col-sm-3">关键字：</label>
				<div class="formControls col-xs-8 col-sm-8">
					<input type="text" class="input-text" value="" placeholder="关键字：" id="filekeys" >
				</div>
			</div>
			
			<div class="row cl">
				<label class="form-label col-xs-4 col-sm-3">文档备注：</label>
				<div class="formControls col-xs-8 col-sm-8">
					<input type="text" class="input-text" value="" placeholder="" id="remark">
				</div>
			</div>
			
			<br />
			<div class="row cl">
				<div style="text-align: center">
					<input class="btn btn-primary radius" id="btnSubmit" type="submit" value="&nbsp;&nbsp;提交&nbsp;&nbsp;" />
					&nbsp;&nbsp;
					<button onclick="layer_close();" class="btn btn-default radius" type="button">
						&nbsp;&nbsp;取消&nbsp;&nbsp;</button>
				</div>
			</div>
		</form>
	</article>
	<!--_footer 作为公共模版分离出去-->

	<script type="text/javascript" src="../../lib/jquery/1.9.1/jquery.min.js"></script>

	<script type="text/javascript" src="../../lib/layer/2.4/layer.js"></script>

	<script type="text/javascript" src="../../static/h-ui/js/H-ui.min.js"></script>

	<script type="text/javascript" src="../../static/h-ui.admin/js/H-ui.admin.js"></script>

	<!--/_footer 作为公共模版分离出去-->
	<!--请在下方写此页面业务相关的脚本-->
	<script type="text/javascript" src="../../lib/My97DatePicker/4.8/WdatePicker.js"></script>
	<script type="text/javascript" src="../../lib/jquery.validation/1.14.0/jquery.validate.js"></script>

	<script type="text/javascript" src="../../lib/jquery.validation/1.14.0/validate-methods.js"></script>

	<script type="text/javascript" src="../../lib/jquery.validation/1.14.0/messages_zh.js"></script>

	<script type="text/javascript" src="../../js/ApiUrl.js"></script>

	<script type="text/javascript" src="../../js/Authority.js"></script>
	
	<script type="text/javascript">
	    var parse = getParseUrl() || [];
		var fileKind = parse["fileKind"];
		
		$(function () {
			$("#tab-category").Huitab({
				index: 0
			});

			function validateForm() {
				return $("#form1").validate({
					rules: {
						fileTitle: { required: true }
					},
					onkeyup: false,
					focusCleanup: true,
					success: "valid",
				}).form();
			}

			function doSubmit() 
			{
				if($('#fileTitle').val()=="")
				{
				    var t1=$('#uploadfile-2').val();
				    if(t1!="")
				    {
				        var pos=t1.lastIndexOf("\\");
				        t1=t1.substring(pos+1);
				        $('#fileTitle').val(t1);
				    }
				}
				if (validateForm()) 
				{
					var url = ES.document.filesCreate;
					var fileFormData = new FormData();
					fileFormData.append('file', $('#file')[0].files[0]);
					
					fileFormData.append('fileKind', fileKind);
					fileFormData.append('num', $('#num').val());
					fileFormData.append('fileTitle', $('#fileTitle').val());
					fileFormData.append('filekeys', $('#filekeys').val());
					fileFormData.append('remark', $('#remark').val());
					
					$.ajax({
						type: "POST",
						url: url,
						processData: false,
						contentType: false,
						cache: false,
						data: fileFormData,
						ok: function (resp) {
							layer.alert("提示：操作成功！", function () {
								var index = parent.layer.getFrameIndex(window.name);
								parent.$('#butSearch').click(); //点击父页面的查询按钮
								parent.layer.close(index);
							});
						}
					});
				}
			}			
			
			$("#btnSubmit").click(function () {
				doSubmit();
			})
		});
	</script>

	<!--/请在上方写此页面业务相关的脚本-->
</body>

</html>
